<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Pinch The Penny HYPE</title>

  <link href="js/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <link href="js/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
  <link href="css/pinch.css" rel="stylesheet">


  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

</head>

<body>
  <canvas id="canvas" style="position:fixed;z-index:100;pointer-events:none;"></canvas>
  <!-- modal -->
  <div class="modal fade" id="bigMoneyModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">NICE</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
          <p>You did it. Thank you for your support. Us devs really appreciate every penny. Are you a big money baller? Dare to give more? Let's find out if you're <a>a big dollar baller </a>or not.</a></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <header class="header" id="top">
    <div class="text-vertical-center">

      <h1 id="banna" style="color:white; background:lightpink;margin-bottom:300px;">
        Pinch The Penny <i class="fa fa-arrow-down" aria-hidden="true"></i></h1>
      &nbsp; &nbsp; &nbsp;
      <h1>
        <img id="penny" src="./img/penny.png" height="200px" width="200px">
      </h1>
      <br>
    </div>
  </header>
  <img id="imgFollow" height="0px" style="transform: rotate(25deg); pointer-events:none;" src="img/penchdapennyhandopen.png" />

  <footer style="background:#2c3e50">
    <div class="container">
      <div class="row">
        <div class="col-lg-10 mx-auto text-center">
          <h4 style="color:white">
            <strong>Frank's Freaks</strong>
          </h4>
          <p style="color:white">FBI Surveillance Van #211
            <br>Miami, FL</p>
          <ul class="list-unstyled">
            <li style="color:white">
              <i style="color:white" class="fa fa-phone fa-fw"></i> 605–475–6968
            </li>
            <li>
              <i style="color:white" lass="fa fa-envelope-o fa-fw"></i>
              <a style="color:white" href="mailto:name@example.com">name@example.com</a>
            </li>
          </ul>
          <br>
          <ul class="list-inline">
            <li class="list-inline-item">
              <a href="#">
                <i class="fa fa-facebook fa-fw fa-3x"></i>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="#">
                <i class="fa fa-twitter fa-fw fa-3x"></i>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="#">
                <i class="fa fa-dribbble fa-fw fa-3x"></i>
              </a>
            </li>
          </ul>
          <hr class="small">
          <p cstyle="color:white" class="text-muted">Made With <i class="fa fa-heart" aria-hidden="true" style: "color:red;"></i> @ Knight Hacks 2k17</p>
        </div>
      </div>
    </div>
    <a id="to-top" href="#top" class="btn btn-dark btn-lg js-scroll-trigger">
      <i class="fa fa-chevron-up fa-fw fa-1x"></i>
    </a>
  </footer>
  <center><img id="piggy" height="300px" style="display:none;" src="img/piggy.PNG" /> </center>
  <script src="js/jquery/jquery.min.js"></script>
  <script src="js/popper/popper.min.js"></script>
  <script src="js/bootstrap/js/bootstrap.min.js"></script>
  <script src="https://checkout.stripe.com/checkout.js"></script>
  <script src="https://dyupuz6787mty.cloudfront.net/packages/typed.min.js"></script>
  <script src="js/jquery-easing/jquery.easing.min.js"></script>
  <script src="js/pinch.js"></script>

  <script>
    $(document).ready(function() {
      $('#myModal').modal()
      $('#imgFollow').attr('height', '350px')
      document.addEventListener('contextmenu', event => event.preventDefault());
      var bannerText = setInterval(function() {
        if (textsindex != 4) {
          $('#banna').html(texts[textsindex] + " <i class='fa fa-arrow-down' aria-hidden='true'>")
          textsindex++
        }
        else {
          textsindex = 0
          $('#banna').html(texts[textsindex] + " <i class='fa fa-arrow-down' aria-hidden='true'>")
        }
      }, 10000);
      var init = true;
      $(this)[init ? 'on' : '']('mousemove', follow);
      $(document)
        .mouseup(function() {
          $('#imgFollow').attr('src', 'img/penchdapennyhandopen.png');
        })
        .mousedown(function() {
          $('#imgFollow').attr('src', 'img/penchdapennyhandclosed.png');
        });

      function follow(e) {
        var xPos = e.pageX;
        var yPos = e.pageY;
        $("#foxlocation").html("The fox is at: " + xPos + ", " + yPos);
        $("#imgFollow").offset({
          left: e.pageX - 125,
          top: e.pageY - 115
        });
      }
    });
    var texts = ["Pinch The Penny", "Don't be shy", "Give it a nice sqeeze", "We surely could appreciate that pinch", "Just click on the damn penny"]
    var textsindex = 0

    var canvas = document.getElementById("canvas");
    var context = canvas.getContext('2d');
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;

    $(window).on('resize', function() {
      width = window.innerWidth;
      height = window.innerHeight;

    });

    colors = ['#61E89E', '#FF8A80', '#F9ED86', '#FFB28E', '#95FFEF', '#D75A6C', '#79C4FC', '#DBDAD9', '#FF405F'];
    symbols = [
      '1¢'
    ]

    objPack = [];
    gravity = 0.05;

    function randomInt(min, max) {
      return Math.floor(min + Math.random() * (max - min + 1));
    }

    function objects(x, y) {
      this.x = x = randomInt(0, width);
      this.y = y = -50 //randomInt(0, width);

      this.w = 50;
      this.h = 50;

      this.a = 1;

      this.fontSize = 42;
      this.fontWeight = '100'
      this.size = 20

      this.vx = randomInt(-1, 1);
      this.vy = randomInt(-1, 1);
      this.color = colors[Math.floor(Math.random() * colors.length)];
      this.symbols = symbols[Math.floor(Math.random() * symbols.length)];
    }

    objects.prototype.draw = function() {
      context.globalAlpha = this.a
      context.save()
      context.font = '100 ' + this.fontSize + 'px bt_mono'
      context.fillText(this.symbols, this.x, this.y)
      context.restore()
      context.fillStyle = this.color
      this.x += this.vx;
      this.y += this.vy;
      this.vy += gravity;
      this.vx *= 0.99;
      this.vy *= 0.99;
      this.size -= 0.05;

      this.a > 0 ? this.a -= 0.003 : this.a = 0
    }

    $(document).ready(function() {
      x = 0;

      setTimeout(function() { x = 1000 }, 7500);

      function update() {
        if (x < 800) {

          context.clearRect(0, 0, width, height);
          context.globalCompositeOperation = "destination-over";

          if (objPack.length < 200) objPack.push(new objects(width / 2, height / 2));

          for (var i = 0; i < objPack.length; i++) {

            objPack[i].draw();

            if (objPack[i].size < 0.1) {
              objPack.splice(0, 1);
            }
          }

          x += 1;
          requestAnimationFrame(update);

        }
        else {
          context.clearRect(0, 0, width, height);
          return;
        }
      }

      update();
    });
  </script>

  <script>
    var handler = StripeCheckout.configure({
      key: 'pk_test_lA29g4AGiTHMK0Q4qwbK0y57',
      image: 'img/penny.png',
      locale: 'auto',
      token: function(token) {
        $("#penny").css({ 'top': $("#penny").position().top-- })
        myMove()
        new Audio("audio/pop.mp3").play()
        var footerHeight = $('footer').position().top
        $('#piggy').fadeIn().css({ 'top': footerHeight - $('#piggy').height(), 'position': 'absolute' })
        setTimeout(function() { InitializeConfetti(); }, 1500);
        SetGlobals();
        new Audio("audio/clap.mp3").play()
        setTimeout(function() { DeactivateConfetti() }, 6000);
      }
    });
    $('#penny').click(function() {
      $('#penny').attr('src', 'img/PennyPinched.png')
      handler.open({
        name: 'Pinchdapenny',
        description: '1 Cent Donation to hardworking devs',
        zipCode: true,
        amount: 1,
        bitcoin: true,
        closed: wascanceled
      });
    })

    // Close Checkout on page navigation:
    window.addEventListener('popstate', function() {
      handler.close();
    });

    function wascanceled(data) {
      $('#penny').attr('src', 'img/penny.png')

    }

    function myMove() {
      var daCoin = $("#penny").position()
      var daPig = $('#piggy').position()
      var id = setInterval(frame, 3);
      var id2;
      var id3;
      var addLeft = 1
      var addBottom = 1

      function frame() {
        if (daCoin.top <= -225) {
          clearInterval(id);
          console.log("DONE?")
          id2 = setInterval(frame2, 3);
        }
        else {
          daCoin.top--;
          $("#penny").css({ 'top': daCoin.top })
        }
      }

      function frame2() {
        console.log(addLeft)
        if (addLeft >= 155) {
          clearInterval(id2);
          console.log("DONE?2?")
          $("#penny").css({ 'transform': 'rotateY(78deg)' })
          id3 = setInterval(frame3, 4);
        }
        else {
          console.log("TO DA ELFT?")
          addLeft++
          $("#penny").css({ 'left': addLeft })
        }
      }

      function frame3() {
        if (daCoin.top >= 100) {
          clearInterval(id3);
          console.log("DONE?3?")
          $("#penny").attr('src', 'img/pennyAfter.png')
          $('#piggy').attr('src', 'img/piggywink.png')
          $('#bigMoneyModal').modal('show')
        }
        else {
          console.log("TO DA DOWN?")
          daCoin.top++
            $("#penny").css({ 'top': daCoin.top })
        }
      }
    }

    // confetti 
    // globals
    var canvas;
    var ctx;
    var W;
    var H;
    var mp = 150; //max particles
    var particles = [];
    var angle = 0;
    var tiltAngle = 0;
    var confettiActive = true;
    var animationComplete = true;
    var deactivationTimerHandler;
    var reactivationTimerHandler;
    var animationHandler;

    // objects

    var particleColors = {
      colorOptions: ["DodgerBlue", "OliveDrab", "Gold", "pink", "SlateBlue", "lightblue", "Violet", "PaleGreen", "SteelBlue", "SandyBrown", "Chocolate", "Crimson"],
      colorIndex: 0,
      colorIncrementer: 0,
      colorThreshold: 10,
      getColor: function() {
        if (this.colorIncrementer >= 10) {
          this.colorIncrementer = 0;
          this.colorIndex++;
          if (this.colorIndex >= this.colorOptions.length) {
            this.colorIndex = 0;
          }
        }
        this.colorIncrementer++;
        return this.colorOptions[this.colorIndex];
      }
    }

    function confettiParticle(color) {
      this.x = Math.random() * W; // x-coordinate
      this.y = (Math.random() * H) - H; //y-coordinate
      this.r = RandomFromTo(10, 30); //radius;
      this.d = (Math.random() * mp) + 10; //density;
      this.color = color;
      this.tilt = Math.floor(Math.random() * 10) - 10;
      this.tiltAngleIncremental = (Math.random() * 0.07) + .05;
      this.tiltAngle = 0;

      this.draw = function() {
        ctx.beginPath();
        ctx.lineWidth = this.r / 2;
        ctx.strokeStyle = this.color;
        ctx.moveTo(this.x + this.tilt + (this.r / 4), this.y);
        ctx.lineTo(this.x + this.tilt, this.y + this.tilt + (this.r / 4));
        return ctx.stroke();
      }
    }

    function SetGlobals() {
      canvas = document.getElementById("canvas");
      ctx = canvas.getContext("2d");
      W = window.innerWidth;
      H = window.innerHeight;
      canvas.width = W;
      canvas.height = H;
    }

    function InitializeConfetti() {
      particles = [];
      animationComplete = false;
      for (var i = 0; i < mp; i++) {
        var particleColor = particleColors.getColor();
        particles.push(new confettiParticle(particleColor));
      }
      StartConfetti();
    }

    function Draw() {
      ctx.clearRect(0, 0, W, H);
      var results = [];
      for (var i = 0; i < mp; i++) {
        (function(j) {
          results.push(particles[j].draw());
        })(i);
      }
      Update();

      return results;
    }

    function RandomFromTo(from, to) {
      return Math.floor(Math.random() * (to - from + 1) + from);
    }


    function Update() {
      var remainingFlakes = 0;
      var particle;
      angle += 0.01;
      tiltAngle += 0.1;

      for (var i = 0; i < mp; i++) {
        particle = particles[i];
        if (animationComplete) return;

        if (!confettiActive && particle.y < -15) {
          particle.y = H + 100;
          continue;
        }

        stepParticle(particle, i);

        if (particle.y <= H) {
          remainingFlakes++;
        }
        CheckForReposition(particle, i);
      }

      if (remainingFlakes === 0) {
        StopConfetti();
      }
    }

    function CheckForReposition(particle, index) {
      if ((particle.x > W + 20 || particle.x < -20 || particle.y > H) && confettiActive) {
        if (index % 5 > 0 || index % 2 == 0) //66.67% of the flakes
        {
          repositionParticle(particle, Math.random() * W, -10, Math.floor(Math.random() * 10) - 20);
        }
        else {
          if (Math.sin(angle) > 0) {
            //Enter from the left
            repositionParticle(particle, -20, Math.random() * H, Math.floor(Math.random() * 10) - 20);
          }
          else {
            //Enter from the right
            repositionParticle(particle, W + 20, Math.random() * H, Math.floor(Math.random() * 10) - 20);
          }
        }
      }
    }

    function stepParticle(particle, particleIndex) {
      particle.tiltAngle += particle.tiltAngleIncremental;
      particle.y += (Math.cos(angle + particle.d) + 3 + particle.r / 2) / 2;
      particle.x += Math.sin(angle);
      particle.tilt = (Math.sin(particle.tiltAngle - (particleIndex / 3))) * 15;
    }

    function repositionParticle(particle, xCoordinate, yCoordinate, tilt) {
      particle.x = xCoordinate;
      particle.y = yCoordinate;
      particle.tilt = tilt;
    }

    function StartConfetti() {
      W = window.innerWidth;
      H = window.innerHeight;
      canvas.width = W;
      canvas.height = H;
      (function animloop() {
        if (animationComplete) return null;
        animationHandler = requestAnimFrame(animloop);
        return Draw();
      })();
    }

    function ClearTimers() {
      clearTimeout(reactivationTimerHandler);
      clearTimeout(animationHandler);
    }

    function DeactivateConfetti() {
      confettiActive = false;
      ClearTimers();
    }

    function StopConfetti() {
      animationComplete = true;
      if (ctx == undefined) return;
      ctx.clearRect(0, 0, W, H);
    }

    function RestartConfetti() {
      ClearTimers();
      StopConfetti();
      reactivationTimerHandler = setTimeout(function() {
        confettiActive = true;
        animationComplete = false;
        InitializeConfetti();
      }, 100);

    }

    window.requestAnimFrame = (function() {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          return window.setTimeout(callback, 1000 / 60);
        };
    })();
  </script>


</body>

</html>
